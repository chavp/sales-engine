(function(){angular.module("salesHubApp",["ngRoute","ngSanitize","ngAnimate","ui.bootstrap"]);function e(e,o){e.when("/",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/home",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/leads",{templateUrl:"/leads/leads.view.html",controller:"leadsCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});o.html5Mode({enabled:true,requireBase:false})}angular.module("salesHubApp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","$window","accounts",function(e,o,r,n){if(!n.isLoggedIn()){o.path("/")}else{if(o.path()==="/"){o.path("/home")}}}])})();(function(){angular.module("salesHubApp").controller("homeCtrl",e);e.$inject=["$scope","$location","accounts"];function e(e,o,r){var n=this;n.currentPath=o.path();n.message="Hello";n.doLogout=function(){r.logout();o.path("/")}}})();(function(){angular.module("salesHubApp").controller("loginCtrl",e);e.$inject=["$location","$window","accounts"];function e(e,o,r){var n=this;n.currentPath=e.path();n.message="TEST";n.credentials={username:"",password:""};n.errorEmail="";n.errorPassword="";n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";n.errorUsername="";n.errorPassword="";if(!n.credentials.username){n.errorUsername="Required"}if(!n.credentials.password){n.errorPassword="Required"}if(n.errorPassword||n.errorPassword){return false}n.doLogin()};n.doLogin=function(){n.formError="";r.login(n.credentials).error(function(e){n.formError=e.message}).then(function(){o.location="/home"})};if(r.isLoggedIn()){leftNavigationCtrl.isLoggedIn;e.path("/home")}}})();(function(){var e="sales_hub_token";angular.module("salesHubApp").service("accounts",o);o.$inject=["$http","$window"];function o(o,r){var n=function(o){r.localStorage[e]=o};var t=function(){return r.localStorage[e]};var a=function(){var e=t();if(e){var o=JSON.parse(r.atob(e.split(".")[1]));return o.exp>Date.now()/1e3}else{return false}};var i=function(e){if(a()){var n=t();var i=JSON.parse(r.atob(n.split(".")[1]));var l=i._id;o.get("/api/accounts/"+l,{headers:{Authorization:"Bearer "+n}}).success(function(o){if(e){e({email:o.email,name:o.profile.firstName+" "+o.profile.lastName,phone:o.profile.phone})}})}};register=function(e){return o.post("/api/accounts/register",e).success(function(e){n(e.token)})};login=function(e){return o.post("/api/accounts/login",e).success(function(e){n(e.token)})};logout=function(){r.localStorage.removeItem(e)};return{getCurrentUser:i,saveToken:n,getToken:t,isLoggedIn:a,register:register,login:login,logout:logout}}})();